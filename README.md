# Week 4 Headstarter Accelerator Project 4 AI Coding Agent
# AI Review Agent

This is a GitHub App that reviews pull requests and submits reviews with AI.

## Setup

1. Download NGROK [here](https://download.ngrok.com/). This will be used to create a secure tunnel to your local server.

2. Run NGROK in your terminal with the following command:

```
ngrok http 3000
```

Here you'll see a URL in the format of `https://<random>.ngrok.app`. Make sure to save this URL as you'll need it to configure your GitHub App.

3. Create a new [GitHub App here](https://github.com/settings/apps)

- Make sure to paste the NGROK URL + `/api/review` (e.g. `https://4836-204-48-36-234.ngrok-free.app/api/review`) as the "Webhook URL"
- Create a webhook secret, this can be anything and then paste it in the "secret" field when setting up the GitHub app
- Make sure to grant the app the read & write permissions for the following:
  - Pull Requests
  - Repository Contents
  - Issues
  - Commit Statuses
  - Webhooks
- Subscribe to the following events:

  - Pull Request
  - Pull Request Review
  - Pull Request Review Comment
  - Pull Request Comment Thread
  - Commit Comment

- Download your private key - this will be used later on to authenticate your app

- Install your GitHub app to all of your repositories

4. Clone the repo

```
git clone https://github.com/CoderAgent/SecureAgent
cd SecureAgent
```

5. Install dependencies

```
npm install
```

6. Get your Groq API key [here](https://console.groq.com/keys). Through Groq, you'll have free access to the Llama and Gemini models.

7. Create a `.env` file in the root of the project with the following variables:

```
GITHUB_PRIVATE_KEY="-----BEGIN RSA PRIVATE KEY-----
<your-github-private-key>
-----END RSA PRIVATE KEY-----"
GITHUB_APP_ID=<your-app-id>
GITHUB_WEBHOOK_SECRET=<your-webhook-secret>
GROQ_API_KEY=<your-groq-api-key>
```

Make sure your GITHUB_PRIVATE_KEY is formatted correctly, with the "--- BEGIN RSA PRIVATE KEY ---" and "--- END RSA PRIVATE KEY ---" lines, and is enclosed in quotes.

8. Within the `SecureAgent` directory in your IDE, run the code with the following command:

```
npm run start
```

9. Create a pull request on one of your repositories and watch the review agent submit a review!
  - Make sure to create the pull request on a repository that your GitHub app has access to.
  - Make sure the pull request has at least one changed file that is supported by the review agent. The following file extensions are ignored: ".pdf", ".png", ".jpg", ".jpeg", ".gif", ".mp4", ".mp3", ".md", ".json", ".env", ".toml", and ".svg".
  - You will have to create new pull requests each time to test the review agent, as it will not work on the same pull request twice.
 


# Step-by-step setup guide builds off the SecureAgent
This step-by-step setup guide builds off the SecureAgent README, found here:
https://github.com/CoderAgent/SecureAgent/blob/main/README.md
Common reasons why the agent is not functioning properly are in green.
 
**Setting up and Configuring NGROK**
 
1. Download the NGROK executable from https://download.ngrok.com/. This will be used to
create a secure tunnel to your local server.

2. Grab your NGROK auth token by visiting this link:
https://dashboard.ngrok.com/get-started/your-authtoken

3. Open the NGROK executable you downloaded. This will open a new terminal window.
Inside the terminal window, configure NGROK with the following command:
ngrok config add-authtoken <your_auth_token_here>
 
4. Run NGROK in your terminal with the following command:
ngrok http 3000

You should now see a Forwarding URL in the format of ` https://<random>.ngrok-free.app`.
Make sure to save this URL as you'll need it to configure your GitHub App.
Note: If you Ctrl+C to close ngrok and then restart it, that will generate a brand new URL. This
means you’ll need to update the WebHook URL in your GitHub app's configuration (introduced
in the next section).

**Creating your GitHub App**
 
5. Create a new GitHub App here: https://github.com/settings/apps

Then, complete the following:

- Name the App anything you want, and just use your GitHub profile URL for the
 Homepage URL.

- Use the URL generated by NGROK as the "Webhook URL", and add `/api/review` to the
 end of it (example: `https://4836-204-48-36-234.ngrok-free.app/api/review`).

- Make up a combination of characters to use for the webhook secret (this can be
 anything). Copy this somewhere, because you’ll need it for one of the environment
variables in a bit.

- For the repository permissions, grant the app read & write permissions for the following:
  - Commit statuses
  - Contents
  - Issues- Pull requests
  - Webhooks

- Subscribe to the following events:
  - Commit comment
  - Pull request
  - Pull request review
  - Pull request review comment
  - Pull Request review thread

- Click the "Create GitHub App" button.

6. Click the "generate a private key" hyperlink, followed by the "Generate a private key" button.
This should automatically download your private key (this will be used for one of the
environment variables.)

7. Install your GitHub app to all of your repositories by clicking the "Install App" tab from the left
pane of the current page, and then select "All repositories."

**Setting up the SecureAgent Application**
 
8. Open another terminal and navigate to where you’d like to clone the SecureAgent repo to.
Then, run the following to clone it:
git clone https://github.com/CoderAgent/SecureAgent

9. cd into the cloned repository by running:
cd SecureAgent

10. Run the following to make sure you are using the latest version of npm:
npm install-g npm@latest

11. Then, run the following to install the project dependencies:
npm install

**Setting up the Environment Variables**

12. Open the SecureAgent project in your IDE, and create a `.env` file with the following
variables:
```
 GITHUB_PRIVATE_KEY=
 GITHUB_APP_ID=
 GITHUB_WEBHOOK_SECRET=
 GROQ_API_KEY=
```

For GITHUB_PRIVATE_KEY, locate the .pem file that was downloaded following the creation of
the GitHub App in Step 6, and open it in a text editor such as Notepad.
 
Copy and paste the entire contents of the file, beginning with-----BEGIN RSA PRIVATE
KEY----- and ending with-----END RSA PRIVATE KEY----
 
Lastly, wrap the pasted contents in quotes ("---.....---").

For GITHUB_APP_ID, go to https://github.com/settings/apps and click on the App you created.

In the About section, you’ll see the App ID.

For GITHUB_WEBHOOK_SECRET, this is the combination of characters you used for the
webhook secret when creating your GitHub App in Step 5.

For GROQ_API_KEY, create a Groq API key here: https://console.groq.com/keys. Through
Groq, you'll have free access to the Llama and Gemini models.

Note: Make sure to save this file after creating it. You’ll also want to create a .gitignore file and
add .env to it, so that your environment variables do not get stored on GitHub.
 
13. Within the SecureAgent directory in your IDE’s terminal, run the following to spin up the
SecureAgent:
npm run start

**Creating a Pull Request to Test the Functionality**

14. In another IDE window, open a JavaScript project you’ve worked on in the past.

15. In that window, open the terminal and create a new branch by running:
git checkout-b <branch-name>

16. Make changes to the project, then run the usual series of commands to push the changes to
GitHub:
```
git add .
git commit-m "..."
git push origin <branch-name>
```

18. After pushing the changes, the terminal should output the following:
remote:
remote: Create a pull request for <branch-name>' on GitHub by visiting:
remote: https://github.com/<username>/<project-name>/pull/new/<branch-name>
 
**Final Step**. Visit the link provided in the terminal and open a new pull request. Give the pull
request a name and a description, then click “Create Pull Request.”

Upon creating the pull request, you should be brought to a page that looks like this:

![image](https://github.com/user-attachments/assets/2d27fe97-4e36-4a81-a697-c5263aa941ad)


By simply waiting on this page for 3-4 seconds, you should see the Pull Request analysis
appear as a comment from your GitHub App (bot).




















